# Multi-stage build for Pyright
ARG VERSION=1.1.407
FROM node:22-slim AS builder
ARG VERSION
RUN npm install -g pyright@${VERSION}

FROM node:22-slim
LABEL org.opencontainers.image.version="${VERSION}"
COPY --from=builder /usr/local/lib/node_modules /usr/local/lib/node_modules
COPY --from=builder /usr/local/bin/pyright /usr/local/bin/pyright
COPY --from=builder /usr/local/bin/pyright-langserver /usr/local/bin/pyright-langserver

# Pyright needs node to run
WORKDIR /workspace
ENTRYPOINT ["pyright-langserver", "--stdio"]
